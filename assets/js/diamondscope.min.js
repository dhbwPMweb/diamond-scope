var DiamondScope=function(){var n=function(e,n,i,t,s){this.question=e,this.answers=n,this.rightAnswer=i,this.difficulty=t,this.id=s,this.used=!1};n.prototype={getRightAnswer:function(){return this.rightAnswer}};var t=function(e,n){this.id=e,this.name=n,this.questionCount=0,this.joker={fifty:1,audience:1}};t.prototype={useJoker:function(e){return 0==e?0!=this.joker.fifty?(this.joker.fifty=0,r.useFiftyFifty(d.rightAnswer)):[]:1==e?0!=this.joker.audience?(this.joker.audience=0,r.useAudience(d.difficulty,d.rightAnswer)):[]:void 0}};var s=function(e){this.round=0,this.players=[],this.gameMode=void 0,this.ranking={rounds:{},points:{}},this.questions=e,this.questionID=0,this.currentPlayer=0,this.expulsedPlayers=void 0};s.prototype={addPlayer:function(e){id=this.players.length,this.players.push(new t(id,e))},useFiftyFifty:function(e){var n=[!1,!1,!1,!1];n[e]=!0;for(var i=parseInt(4*Math.random());i==e;)i=parseInt(4*Math.random());return n[i]=!0,n},useAudience:function(e,n){var i;switch(e){case 0:i=0;break;case 1:i=5;break;case 2:i=9;break;case 3:i=13;break;case 4:i=17;break;default:i=0}var t=[];t[0]=parseInt(20*Math.random())+40-i,t[1]=parseInt((100-t[0])/3*(Math.random()+.4)),t[2]=parseInt((100-t[0])/3*(Math.random()+.4)),t[3]=100-t[0]-t[1]-t[2];var s=t[n];return t[n]=t[0],t[0]=s,t},nextPlayer:function(){for(this.currentPlayer++,this.currentPlayer==this.players.length&&(this.currentPlayer=0);this.expulsedPlayers[this.currentPlayer];)this.currentPlayer++,this.currentPlayer==this.players.length&&(this.currentPlayer=0)},conclude:function(){return obj=this,1==obj.gameMode?(obj.players.sort(function(e,n){return n.questionCount-e.questionCount}),void 0==obj.ranking.rounds[obj.players[0].id]&&(r.ranking.rounds[r.players[0].id]=0),obj.ranking.rounds[obj.players[0].id]++,content="<h1>Herzlichen Glückwunsch "+obj.players[0].name+"</h1>",obj.players.forEach(function(e,n){e.questionCount--,void 0===obj.ranking.points[e.id]&&(obj.ranking.points[e.id]=0),obj.ranking.points[e.id]+=e.questionCount,content+="<h1>"+(n+1)+". "+e.name+" mit "+e.questionCount+" Punkten</h1>",e.questionCount=0,e.joker.audience=1,e.joker.fifty=1})):0==obj.gameMode&&(player=obj.players[0],player.questionCount--,content="<h1>Du hast "+player.questionCount+" von "+QUESTIONS_PER_ROUND+" Fragen richtig beantwortet!</h1>",void 0==obj.ranking.points[0]&&(obj.ranking.points[0]=0),obj.ranking.points[0]+=player.questionCount,player.questionCount=0,player.joker.audience=1,player.joker.fifty=1),content},end:function(){return content="",this.round++,0==r.gameMode?content+="<h1>Du hast "+this.round+" Runden gespielt und dabei "+obj.ranking.points[0]+" Punkte erreicht</h1>":1==r.gameMode&&(obj=this,r.players.sort(function(e,n){obj.ranking.points[n.id]-obj.ranking.points[e.id]}),r.players.forEach(function(e,n){void 0===obj.ranking.rounds[e.id]&&(obj.ranking.rounds[e.id]=0),content+="<h1>"+(n+1)+". "+e.name+" mit "+obj.ranking.points[e.id]+" Punkten und "+obj.ranking.rounds[e.id]+" gewonnenen Runden</h1>"})),content}};var d,r,a=[],o=-1,l=function(){u(),c(),$.getJSON(SERVER_URL+QUESTION_FILE,function(e){a=e,a.forEach(function(e,i){a[i]=new n(e.question,e.answers,e.rightAnswer,e.difficulty,e.id)}),v()})},c=function(){$(window).resize(function(){u()}),$(document).on("click","#joker-fifty",function(){$(this).addClass("disabled"),answers=r.players[r.currentPlayer].useJoker(0),answers.forEach(function(e,n){e||(char=0==n?"a":1==n?"b":2==n?"c":"d",$("#answer-"+char).html(""),$("#answer-"+char).parent().addClass("disabled"))})}),$(document).on("click","#joker-audience",function(){$(this).addClass("disabled"),answers=r.players[r.currentPlayer].useJoker(1),answers.forEach(function(e,n){char=0==n?"a":1==n?"b":2==n?"c":"d",$("#answer-"+char).html(answers[n]+"%")})}),$(document).on("click",".answer",function(){$(this).hasClass("disabled")||($(".answer").addClass("disabled"),id=$(this).data("id"),id==d.rightAnswer?($(this).addClass("green"),setTimeout(function(){1==r.gameMode&&r.nextPlayer(),h()},1500)):($(this).addClass("red"),$(".answer").each(function(){$(this).data("id")==d.rightAnswer&&$(this).addClass("yellow")}),setTimeout(function(){f()},1500)))})},u=function(){-1==o&&(o=$(window).width()<1200?1400:1e3),console.log(o),$(window).width()<1200&&o>=1200?($("body > .container-fluid").css("height","0"),$("body > #main-center.container-fluid").css({height:"99%"}),$("#main-card").css("margin","0"),$("#video-background, #video-background-inner").attr("src",""),$("#video-background-inner").css({left:"0",top:"0",width:"100%"})):$(window).width()>=1200&&1200>o&&($("body > .container-fluid").css("height","15%"),$("body > #main-center.container-fluid").css({height:"70%"}),$("#main-card").css("margin","5px"),$("#video-background").attr("src","assets/videos/QuzzeldullBackgroundLoopCompressed.mp4"),$("#video-background-inner").attr("src","assets/videos/QuzzeldullBackgroundLoopBlurCompressed.mp4"),$("#video-background-inner").css({left:"-25%",top:"-25%",width:"150%"})),o=$(window).width(),$(window).outerHeight()/9>$(window).outerWidth()/16?($("body > #video-background").css({width:"auto",height:"100%"}),$("#video-background-inner").css({width:"auto",height:"150%"})):($("body > #video-background").css({width:"100%",height:"auto"}),$("#video-background-inner").css({width:"150%",height:"auto"})),$(".vertical-center").each(function(){$(this).css("margin-top",$($(this).attr("data-container")).outerHeight()/2-$(this).outerHeight())}),$(".vertical-center-2").each(function(){$(this).css("margin-top",$($(this).attr("data-container")).outerHeight()/2-$(this).outerHeight()/2)})},v=function(){r=new s(a),g.startMenu()},h=function(){difficulty=Math.floor(r.players[r.currentPlayer].questionCount++/3),r.players[r.currentPlayer].questionCount<=QUESTIONS_PER_ROUND?g.frage(difficulty):g.endView()},f=function(){0==r.gameMode?g.endView():1==r.gameMode&&(r.expulsedPlayers[r.currentPlayer]=!0,size=function(n){size=0;for(e in n)size++;return size}(r.expulsedPlayers),size==r.players.length?g.endView():(r.nextPlayer(),h()))},g=function(){var e=function(){content='<div class="container-fluid logo-box"><div class="row"><div class="col-md-8 col-centered"><img src="assets/svgs/quzzeldull_logo_text_horizontal.svg" class="img-responsive start-logo" alt="Diamond Scope"></div></div></div><div class="vertical-center container-fluid button-box" data-container="#main-center"><div class="menu-button col-centered rounded-div main-design btn" id="singleplayer-button"><h1>Singleplayer</h1></div><div class="clearfix"></div><div class="menu-button col-centered rounded-div main-design btn" id="multiplayer-button"><h1>Multiplayer</h1></div><div class="clearfix"></div></div>',$("#content-div").html(content),$("#singleplayer-button").on("click",function(){$(this).off("click"),g(n)}),$("#multiplayer-button").on("click",function(){$(this).off("click"),g(t)})},n=function(){content='<div class="container-fluid vertical-center-2" data-container="#main-center"><div class="row" id="player-row"><div class="col-lg-6 col-centered"><div class="main-design"><h1>Spielername</h1></div></div></div><div class="row"><div class="col-lg-6 col-centered"><div class="main-design"><input type="text" class="main-design names" id="player-name"></div></div></div><div class="row" id="button-row"><div class="player-screen-button pull-left"><div class="main-design rounded-div btn" id="back-button"><h1>Zur&uuml;ck</h1></div></div><div class="player-screen-button pull-right"><div class="main-design rounded-div btn" id="next-button"><h1>Weiter</h1></div></div></div></div>',$("#content-div").html(content),$("#back-button").on("click",function(){$(this).off("click"),g(e)}),$("#next-button").on("click",function(){$(this).off("click"),r.addPlayer($("#player-name").val()),r.gameMode=0,g(o),setTimeout(function(){h()},501)})},t=function(){content='<div class="container-fluid vertical-center-2" data-container="#main-center"><div class="row" id="player-row"><div class="col-lg-6 col-centered"><div class="main-design"><h1>Spielernamen</h1></div></div></div><div class="row"><div class="multiplayer-names col-centered relative"><div class="main-design" id="player-names"><input type="text" class="main-design names" id="player-name-1" placeholder="Spieler 1"><input type="text" class="main-design names" id="player-name-2" placeholder="Spieler 2"></div></div>                </div><div class="row" id="button-row"><div class="player-screen-button pull-left"><div class="main-design rounded-div btn" id="back-button"><h1>Zur&uuml;ck</h1></div></div><div class="player-screen-button pull-right"><div class="main-design rounded-div btn" id="next-button"><h1>Weiter</h1></div></div><div class="multiplayer-count btn-group" role="group"><div type="button" id="player-2" data-id="2" class="btn rounded-div main-design count selected"><h1>2</h1></div><div type="button" id="player-3" data-id="3" class="btn rounded-div main-design count"><h1>3</h1></div><div type="button" id="player-4" data-id="4" class="btn rounded-div main-design count"><h1>4</h1></div><div type="button" id="player-5" data-id="5" class="btn rounded-div main-design count"><h1>5</h1></div></div></div></div>',$("#content-div").html(content),$("#back-button").on("click",function(){$(this).off("click"),g(e)}),$(".count").on("click",function(){for($(".count").removeClass("selected"),$(this).addClass("selected"),content="",i=1;i<=$(this).data("id");i++)content+='<input type="text" class="main-design names" id="player-name-'+i+'" placeholder="Spieler '+i+'">';$("#player-names").html(content),u()}),$("#next-button").on("click",function(){$(".names").each(function(){r.addPlayer($(this).val())}),r.gameMode=1,r.questionID++,r.expulsedPlayers={},g(o),setTimeout(function(){h()},501)})},o=function(){content='<div class="container-fluid question-box"><div class="row"><div><div class="col-lg-5 pull-left"><img src="assets/svgs/quzzeldull_logo_text_horizontal.svg" class="img-responsive" alt="Diamond Scope"></div><div class="col-lg-4 pull-right"><div class="main-design" id="current-question"><h3>Frage X</h3></div><div class="main-design" id="player"><h4>Spieler X</h4></div></div></div></div><div class="clearfix"></div><div class="row"><div class="col-lg-12 main-design"><h1 id="question">Wie hei&szlig;t eine gängige Projektmanagement-Methode?</h1></div></div></div><div class="container-fluid answer-box"><div class="container-fluid"><div class="col-md-12 rounded-div main-design answer" data-id="0"><h4 class="pull-left">A</h4><h4 id="answer-a">Duke1</h4></div><div class="col-md-12 rounded-div main-design answer" data-id="1"><h4 class="pull-left">B</h4><h4 id="answer-b">Prince2</h4></div><div class="col-md-12 rounded-div main-design answer" data-id="2"><h4 class="pull-left">C</h4><h4 id="answer-c">King4</h4></div><div class="col-md-12 rounded-div main-design answer" data-id="3"><h4 class="pull-left">D</h4><h4 id="answer-d">Queen3</h4></div></div><div class="row"><div class="col-lg-2 pull-right rounded-div joker-button main-design" id="joker-audience"><h4>Publikum</h4></div><div class="col-lg-2 pull-right rounded-div joker-button main-design" id="joker-fifty"><h4>2 Aus 4</h4></div></div></div>',$("#content-div").html(content)},l=function(){content='<div class="container-fluid question-box"><div class="row"><div><div class="col-lg-5 pull-left"><img src="assets/svgs/quzzeldull_logo_text_horizontal.svg" class="img-responsive" alt="Diamond Scope"></div></div></div></div><div class="vertical-center-2" data-container="#main-center"><div class="row"><div class="col-lg-12 main-design">',content+=r.conclude(),content+='</div></div><div class="menu-button rounded-div main-design btn" id="new-game-button"><h1>Neue Runde</h1></div><div class="menu-button rounded-div main-design btn" id="report-button"><h1>Zur Auswertung</h1></div></div></div>',$("#content-div").html(content),$("#new-game-button").on("click",function(){r.round++<ROUND_LIMIT?(r.questions.forEach(function(e){e.used=!1}),r.expulsedPlayers={},g(o),setTimeout(function(){h()},501)):($(this).html("<h1>Es ist leider nicht möglich mehr als "+ROUND_LIMIT+" Runden zu spielen</h1>"),$(this).off("click"))}),$("#report-button").on("click",function(){c()})},c=function(){content='<div class="container-fluid question-box"><div class="row"><div><div class="col-lg-5 pull-left"><img src="assets/svgs/quzzeldull_logo_text_horizontal.svg" class="img-responsive" alt="Diamond Scope"></div></div></div></div><div class="vertical-center-2" data-container="#main-center"><div class="row"><div class="col-lg-12 main-design">',content+=r.end(),content+='</div></div><div class="menu-button rounded-div main-design btn" id="menu-button"><h1>Zum Hauptmenu</h1></div></div></div>',$("#content-div").html(content),$("#menu-button").on("click",function(){r=new s(a),e()})},v=function(e){function n(e){return selectedQuestions=$.grep(r.questions,function(n){return n.difficulty==e&&0==n.used}),d=selectedQuestions[Math.floor(Math.random()*selectedQuestions.length)],d.used=!0,d}var s,a,o,i=n(e),t=[0,1,2,3],l=i.rightAnswer;for(a=0;4>a;a++)s=Math.floor(Math.random()*(a+1)),s==l?(i.rightAnswer=a,l=a):a==l&&(i.rightAnswer=s,l=s),o=i.answers[a],i.answers[a]=i.answers[s],i.answers[s]=o,o=t[a],t[a]=t[s],t[s]=o;category=" (Kategorie: "+(e+1)+")",player="Spieler "+(r.players[r.currentPlayer].id+1)+" - "+r.players[r.currentPlayer].name,$("#current-question > h3").html("Frage "+r.players[r.currentPlayer].questionCount+category),$("#player > h4").html(player),$("#question").html(i.question),$("#answer-a").html(i.answers[0]),$("#answer-b").html(i.answers[1]),$("#answer-c").html(i.answers[2]),$("#answer-d").html(i.answers[3]),$(".answer").removeClass("red"),$(".answer").removeClass("green"),$(".answer").removeClass("yellow"),$(".answer").removeClass("disabled"),$(".joker-button").removeClass("disabled"),0==r.players[r.currentPlayer].joker.audience&&$("#joker-audience").addClass("disabled"),0==r.players[r.currentPlayer].joker.fifty&&$("#joker-fifty").addClass("disabled");var c=$("audio").get(0),u=$("audio"),v="assets/voices/voice",h=".mp3";u.attr("src",v+i.id+"-q"+h),c.addEventListener("ended",function(){u.attr("src",v+"-answer-a"+h),c.addEventListener("ended",function(){u.attr("src",v+i.id+"-"+t[0]+h),c.addEventListener("ended",function(){u.attr("src",v+"-answer-b"+h),c.addEventListener("ended",function(){u.attr("src",v+i.id+"-"+t[1]+h),c.addEventListener("ended",function(){u.attr("src",v+"-answer-c"+h),c.addEventListener("ended",function(){u.attr("src",v+i.id+"-"+t[2]+h),c.addEventListener("ended",function(){u.attr("src",v+"-answer-d"+h),c.addEventListener("ended",function(){u.attr("src",v+i.id+"-"+t[3]+h),c.addEventListener("ended",function(){c.pause()}),c.play()}),c.play()}),c.play()}),c.play()}),c.play()}),c.play()}),c.play()}),c.play()}),c.play()},f=function(){g(l)},g=function(e){$("#content-div").addClass("fade"),setTimeout(function(){e(),setTimeout(function(){$("#content-div").removeClass("fade")},500),u()},500)};return{startMenu:e,frage:v,endView:f}}();return{init:l,sizeCheck:u}}();$(function(){$(window).load(function(){DiamondScope.sizeCheck(),setTimeout(function(){$("body > #loading").css("opacity","0"),setTimeout(function(){$("body > #loading").remove()},1001)},1500)}),DiamondScope.init()});